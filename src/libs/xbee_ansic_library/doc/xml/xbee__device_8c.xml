<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="xbee__device_8c" kind="file" language="C++">
    <compoundname>xbee_device.c</compoundname>
    <includes local="no">errno.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">string.h</includes>
    <includes refid="platform_8h" local="yes">xbee/platform.h</includes>
    <includes refid="device_8h" local="yes">xbee/device.h</includes>
    <includes refid="serial_8h" local="yes">xbee/serial.h</includes>
    <includes refid="aps_8h" local="yes">wpan/aps.h</includes>
    <includes refid="byteorder_8h" local="yes">xbee/byteorder.h</includes>
    <incdepgraph>
      <node id="1343">
        <label>src/xbee/xbee_device.c</label>
        <link refid="xbee__device_8c"/>
        <childnode refid="1344" relation="include">
        </childnode>
        <childnode refid="1345" relation="include">
        </childnode>
        <childnode refid="1346" relation="include">
        </childnode>
        <childnode refid="1347" relation="include">
        </childnode>
        <childnode refid="1348" relation="include">
        </childnode>
        <childnode refid="1351" relation="include">
        </childnode>
        <childnode refid="1352" relation="include">
        </childnode>
        <childnode refid="1354" relation="include">
        </childnode>
        <childnode refid="1355" relation="include">
        </childnode>
      </node>
      <node id="1351">
        <label>xbee/device.h</label>
        <link refid="device_8h"/>
        <childnode refid="1348" relation="include">
        </childnode>
        <childnode refid="1352" relation="include">
        </childnode>
        <childnode refid="1353" relation="include">
        </childnode>
        <childnode refid="1354" relation="include">
        </childnode>
      </node>
      <node id="1344">
        <label>errno.h</label>
      </node>
      <node id="1349">
        <label>xbee/jslong_glue.h</label>
        <link refid="jslong__glue_8h_source"/>
        <childnode refid="1350" relation="include">
        </childnode>
      </node>
      <node id="1345">
        <label>stddef.h</label>
      </node>
      <node id="1354">
        <label>wpan/aps.h</label>
        <link refid="aps_8h"/>
        <childnode refid="1353" relation="include">
        </childnode>
      </node>
      <node id="1355">
        <label>xbee/byteorder.h</label>
        <link refid="byteorder_8h"/>
        <childnode refid="1347" relation="include">
        </childnode>
        <childnode refid="1348" relation="include">
        </childnode>
      </node>
      <node id="1347">
        <label>string.h</label>
      </node>
      <node id="1353">
        <label>wpan/types.h</label>
        <link refid="types_8h"/>
        <childnode refid="1348" relation="include">
        </childnode>
      </node>
      <node id="1348">
        <label>xbee/platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="1344" relation="include">
        </childnode>
        <childnode refid="1345" relation="include">
        </childnode>
        <childnode refid="1349" relation="include">
        </childnode>
      </node>
      <node id="1352">
        <label>xbee/serial.h</label>
        <link refid="serial_8h"/>
        <childnode refid="1348" relation="include">
        </childnode>
      </node>
      <node id="1350">
        <label>xbee/jslong.h</label>
        <link refid="jslong_8h_source"/>
      </node>
      <node id="1346">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="group__xbee__device_1ga86812c9b592261c600106f7b9afe26a1" prot="public" static="no">
        <name>_xbee_device_debug</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="34" column="10" bodyfile="src/xbee/xbee_device.c" bodystart="34" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="group__xbee__device_1ga9faca10d7a960dcd3c0c3ad9c0d59cab" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref></type>
        <definition>uint8_t xbee_next_frame_id</definition>
        <argsstring>(xbee_dev_t *xbee)</argsstring>
        <name>xbee_next_frame_id</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <briefdescription>
<para>Increment and return current frame ID for a given XBee device. </para>        </briefdescription>
        <detaileddescription>
<para>Frame IDs go from 1 to 255 and then back to 1.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>1-255</parametername>
</parameternamelist>
<parameterdescription>
<para>Current frame ID (after incrementing) for device </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>0</parametername>
</parameternamelist>
<parameterdescription>
<para><emphasis>xbee</emphasis> is not a valid XBee device pointer. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="61" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="61" bodyend="75"/>
        <references refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" compoundref="device_8h" startline="420">xbee_dev_t::frame_id</references>
        <referencedby refid="group__xbee__atcmd_1ga2c58eedef60b41dd30ae1f6b475606a8" compoundref="xbee__atcmd_8c" startline="1404" endline="1485">xbee_cmd_send</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int xbee_dev_init</definition>
        <argsstring>(xbee_dev_t *xbee, const xbee_serial_t *serport, xbee_is_awake_fn is_awake, xbee_reset_fn reset)</argsstring>
        <name>xbee_dev_init</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type>const <ref refid="structxbee__serial__t" kindref="compound">xbee_serial_t</ref> *</type>
          <declname>serport</declname>
        </param>
        <param>
          <type><ref refid="group__xbee__device_1ga47d67ee70583d9a2a0cf7ae1eb672af8" kindref="member">xbee_is_awake_fn</ref></type>
          <declname>is_awake</declname>
        </param>
        <param>
          <type><ref refid="group__xbee__device_1gaa6b2701f8516c2947424178c4bacab83" kindref="member">xbee_reset_fn</ref></type>
          <declname>reset</declname>
        </param>
        <briefdescription>
<para>Initialize the XBee device structure and open a serial connection to a local, serially-attached XBee module. </para>        </briefdescription>
        <detaileddescription>
<para>This function does not actually initiate communications with the XBee module. See <ref refid="group__xbee__atcmd_1ga1cc803f821ed44e27e404d38349f53c7" kindref="member">xbee_cmd_init_device()</ref> for information on initializing the &quot;AT Command&quot; layer of the driver, which will read basic information from the XBee module.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device to initialize.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">serport</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an <ref refid="structxbee__serial__t" kindref="compound">xbee_serial_t</ref> structure used to initialize <emphasis>xbee-&gt;serport</emphasis>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_awake</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to function that reads the XBee module&apos;s &quot;ON&quot; pin. The function should return 1 if XBee is on and 0 if it is off.</para></parameterdescription>
</parameteritem>
</parameterlist>
<programlisting><codeline><highlight class="normal">int<sp/>is_awake(<sp/>xbee_dev_t<sp/>*xbee);<sp/></highlight></codeline>
</programlisting></para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">reset</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to function that asserts the XBee module&apos;s &quot;/RESET&quot; pin. If <emphasis>asserted</emphasis> is TRUE, puts the XBee into reset. If <emphasis>asserted</emphasis> is FALSE, takes it out of reset. No return value.</para></parameterdescription>
</parameteritem>
</parameterlist>
<programlisting><codeline><highlight class="normal">void<sp/>xbee_reset(<sp/>xbee_dev_t<sp/>*xbee,<sp/>bool_t<sp/>asserted);<sp/></highlight></codeline>
</programlisting></para><para><parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>0</parametername>
</parameternamelist>
<parameterdescription>
<para>Success </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EINVAL</parametername>
</parameternamelist>
<parameterdescription>
<para>Invalid parameter (<emphasis>xbee</emphasis> is NULL, <emphasis>serport</emphasis> is not valid, etc.) </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EIO</parametername>
</parameternamelist>
<parameterdescription>
<para>Couldn&apos;t set serial port baudrate within 5% of <emphasis>serport-&gt;baudrate</emphasis>. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="125" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="125" bodyend="169"/>
        <references refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" compoundref="platform_8h" startline="95">EINVAL</references>
        <references refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" compoundref="device_8h" startline="418">xbee_dev_t::flags</references>
        <references refid="group__xbee__device_1gaf17bb63b8639d0278a2d0ad259865930" compoundref="device_8h" startline="368">xbee_dev_t::is_awake</references>
        <references refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" compoundref="device_8h" startline="365">xbee_dev_t::reset</references>
        <references refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" compoundref="device_8h" startline="362">xbee_dev_t::serport</references>
        <references refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" compoundref="device_8h" startline="328">XBEE_DEV_FLAG_USE_FLOWCONTROL</references>
        <references refid="group__hal_1gae29ba672a9f69330a8e16a73a1a11053" compoundref="platform__mbed_8h" startline="71">XBEE_PLATFORM_INIT</references>
        <references refid="group__hal__dos_1ga1f5f72ffdfbfb45ac523640db32296ff" compoundref="xbee__serial__dos_8c" startline="583" endline="591">xbee_ser_flowcontrol</references>
        <references refid="group__hal__dos_1gaa615a221dd69c17ee2989c281f2bf04a" compoundref="xbee__serial__dos_8c" startline="449" endline="545">xbee_ser_open</references>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1ga75bfe1292b8af0588e0e322a42d3d2dc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void xbee_dev_flowcontrol</definition>
        <argsstring>(xbee_dev_t *xbee, bool_t enabled)</argsstring>
        <name>xbee_dev_flowcontrol</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga04dd5074964518403bf944f2b240a5f8" kindref="member">bool_t</ref></type>
          <declname>enabled</declname>
        </param>
        <briefdescription>
<para>Control whether <ref refid="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" kindref="member">xbee_frame_write()</ref> checks the XBee CTS signal before sending frames. </para>        </briefdescription>
        <detaileddescription>
<para>Flow control is enabled in <ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref> by default.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="inout">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee to configure </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">enabled</parametername>
</parameternamelist>
<parameterdescription>
<para>TRUE to enable checking CTS before sending</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref>, <ref refid="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" kindref="member">xbee_frame_write()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="186" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="186" bodyend="199"/>
        <references refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" compoundref="device_8h" startline="418">xbee_dev_t::flags</references>
        <references refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" compoundref="device_8h" startline="328">XBEE_DEV_FLAG_USE_FLOWCONTROL</references>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1ga96267a6b36d9a1b1d59b16cc60a2b09a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void xbee_dev_dump_settings</definition>
        <argsstring>(xbee_dev_t *xbee, uint16_t flags)</argsstring>
        <name>xbee_dev_dump_settings</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>flags</declname>
        </param>
        <briefdescription>
<para>Print information to stdout about the XBee device. </para>        </briefdescription>
        <detaileddescription>
<para>Default behavior is to print the name of the serial port, the XBee module&apos;s hardware version (ATHV), firmware version (ATVR), IEEE address (ATSH/ATSL) and network address (ATMY).</para><para>Assumes the user has already called <ref refid="group__xbee__atcmd_1ga1cc803f821ed44e27e404d38349f53c7" kindref="member">xbee_cmd_init_device()</ref> and waited for <ref refid="group__xbee__atcmd_1ga83f36dfc3c3cd2c4046719ea6e9cc53c" kindref="member">xbee_cmd_query_status()</ref> to finish.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">flags</parametername>
</parameternamelist>
<parameterdescription>
<para><itemizedlist>
<listitem><para>XBEE_DEV_DUMP_FLAG_NONE: default settings</para></listitem></itemizedlist>
</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__xbee__atcmd_1ga1cc803f821ed44e27e404d38349f53c7" kindref="member">xbee_cmd_init_device()</ref>, <ref refid="group__xbee__atcmd_1ga83f36dfc3c3cd2c4046719ea6e9cc53c" kindref="member">xbee_cmd_query_status()</ref>, <ref refid="group__hal__dos_1ga898057d1b7645785e7f3d6256828d039" kindref="member">xbee_ser_portname()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="226" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="226" bodyend="238"/>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gad312efa700cca7ca044cddf364cc51f5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int xbee_dev_reset</definition>
        <argsstring>(xbee_dev_t *xbee)</argsstring>
        <name>xbee_dev_reset</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <briefdescription>
<para>Toggles the reset line of the XBee device. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device to reset.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>0</parametername>
</parameternamelist>
<parameterdescription>
<para>Successfully toggled reset. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EINVAL</parametername>
</parameternamelist>
<parameterdescription>
<para>Invalid <ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> passed to function. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EIO</parametername>
</parameternamelist>
<parameterdescription>
<para>This XBee device doesn&apos;t have an interface to the module&apos;s reset pin. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="255" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="255" bodyend="281"/>
        <references refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" compoundref="platform_8h" startline="95">EINVAL</references>
        <references refid="group__hal_1ga70979f50f9c83e5aebab3d6a1bd4cf35" compoundref="platform_8h" startline="98">EIO</references>
        <references refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" compoundref="device_8h" startline="365">xbee_dev_t::reset</references>
        <references refid="group__hal_1ga848a9903fa7859d84cb22aeddde4c42f" compoundref="platform_8h" startline="627">XBEE_SET_TIMEOUT_MS</references>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int xbee_dev_tick</definition>
        <argsstring>(xbee_dev_t *xbee)</argsstring>
        <name>xbee_dev_tick</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <briefdescription>
<para>Check for newly received frames on an XBee device and dispatch them to registered frame handlers. </para>        </briefdescription>
        <detaileddescription>
<para>A program with an XBee interface needs to call this function often enough to keep up with inbound bytes.</para><para>Execution time depends greatly on how long each frame handler takes to process its frame.</para><para><simplesect kind="warning"><para>This function is NOT re-entrant and will return -EBUSY if it is called when already running.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device to check for, and then dispatch, new frames.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>&gt;=0</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of frames received and dispatched. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EINVAL</parametername>
</parameternamelist>
<parameterdescription>
<para>If <emphasis>xbee</emphasis> isn&apos;t a valid device structure. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EBUSY</parametername>
</parameternamelist>
<parameterdescription>
<para>If <ref refid="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" kindref="member">xbee_dev_tick()</ref> was called when it&apos;s already running for this device. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="309" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="309" bodyend="337"/>
        <references refid="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" compoundref="xbee__device_8c" startline="625" endline="805">_xbee_frame_load</references>
        <references refid="group__hal_1ga8368025077a0385849d6817b2007c095" compoundref="platform_8h" startline="101">EBUSY</references>
        <references refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" compoundref="platform_8h" startline="95">EINVAL</references>
        <references refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" compoundref="device_8h" startline="418">xbee_dev_t::flags</references>
        <references refid="group__hal_1ga658c3ad175b50000ac44b3b9ea836d1a" compoundref="platform_8h" startline="381">INTERRUPT_DISABLE</references>
        <references refid="group__hal_1gacf43057fc38f77d20456c074909ba772" compoundref="platform_8h" startline="377">INTERRUPT_ENABLE</references>
        <references refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea87374abf657f1ed82b4eafdb287cbb11" compoundref="device_8h" startline="318">XBEE_DEV_FLAG_IN_TICK</references>
        <referencedby refid="group__xbee__wpan_1ga7c0492680badfd8ee30c5d797395394f" compoundref="xbee__wpan_8c" startline="162" endline="165">_xbee_wpan_tick</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gac7c192386ffce72242c2c8494b261491" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void _xbee_dispatch_table_dump</definition>
        <argsstring>(const xbee_dev_t *xbee)</argsstring>
        <name>_xbee_dispatch_table_dump</name>
        <param>
          <type>const <ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<internal><para>Dump the contents of the frame dispatch table for XBee device <emphasis>xbee</emphasis>. Must have XBEE_DEVICE_VERBOSE defined.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device of table to dump. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="350" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="350" bodyend="379"/>
        <references refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" compoundref="device_8h" startline="295">xbee_dispatch_table_entry_t::frame_id</references>
        <references refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" compoundref="device_8h" startline="294">xbee_dispatch_table_entry_t::frame_type</references>
        <references refid="group__hal_1ga8429a3beb3448b89cb7c3877b8909369" compoundref="platform_8h" startline="409">PRIpFAR</references>
        <references refid="group__xbee__device_1ga1a91a1dc6e99737715fbf882842872c5">xbee_frame_handlers</references>
        <references refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" compoundref="platform_8h" startline="399">XBEE_UNUSED_PARAMETER</references>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref>()</type>
        <definition>uint8_t _xbee_checksum</definition>
        <argsstring>(const void FAR *bytes, uint16_t length, uint_fast8_t initial)</argsstring>
        <name>_xbee_checksum</name>
        <param>
          <type>const void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>bytes</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>length</declname>
        </param>
        <param>
          <type>uint_fast8_t</type>
          <declname>initial</declname>
        </param>
        <briefdescription>
<para>Calculate the checksum for an XBee frame. </para>        </briefdescription>
        <detaileddescription>
<internal><para>This function actually subtracts bytes from 0xFF, in order to determine the proper checksum byte so all bytes added together result in 0x00.</para><para>Frame checksums start with the frame type (first byte after frame length).</para><para>If calculating a checksum for an outgoing packet, sum all of the bytes using this function, and send the low byte of the result.</para><para>If verifying a received packet, summing all of the bytes after the length, including the packet&apos;s checksum byte, should result in 0x00.</para><para>Should only be used internally by this library.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">bytes</parametername>
</parameternamelist>
<parameterdescription>
<para>Buffer of bytes to add to sum, assumed non-NULL.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">length</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of bytes to add.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">initial</parametername>
</parameternamelist>
<parameterdescription>
<para>Starting checksum value. Use 0xFF to start or the result of the previous call if summing multiple blocks of data.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Value from 0x00 to 0xFF that, when added to all bytes previously checksummed, results in a low byte of 0x00. </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="420" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="420" bodyend="434"/>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int xbee_frame_write</definition>
        <argsstring>(xbee_dev_t *xbee, const void FAR *header, uint16_t headerlen, const void FAR *data, uint16_t datalen, uint16_t flags)</argsstring>
        <name>xbee_frame_write</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type>const void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>header</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>headerlen</declname>
        </param>
        <param>
          <type>const void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>datalen</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>flags</declname>
        </param>
        <briefdescription>
<para>Copies a frame into the transmit serial buffer to send to an XBee module. </para>        </briefdescription>
        <detaileddescription>
<para>Header should include bytes as they will be sent to the XBee. Function accepts separate header and data to limit the amount of copying necessary to send requests.</para><para>This function should only be called after <emphasis>xbee</emphasis> has been initialized by calling <ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref>.</para><para>By default, <ref refid="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" kindref="member">xbee_frame_write()</ref> checks the /CTS signal from the XBee before attempting to send, and will return -EBUSY if the XBee has deasserted CTS. Use <ref refid="group__xbee__device_1ga75bfe1292b8af0588e0e322a42d3d2dc" kindref="member">xbee_dev_flowcontrol()</ref> to disable this check (necessary on a system without a connection to the XBee module&apos;s /CTS signal).</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device to send to.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">header</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the header to send. Header starts with the frame type (this function will pre-pend the 0x7E start-of-frame and 16-bit length). Pass <computeroutput>NULL</computeroutput> if there isn&apos;t a header and the entire frame is in the payload (<emphasis>data</emphasis> and <emphasis>datalen</emphasis>).</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">headerlen</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of header bytes to send (starting with address passed in <emphasis>header</emphasis>). Ignored if <emphasis>header</emphasis> is <computeroutput>NULL</computeroutput>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">data</parametername>
</parameternamelist>
<parameterdescription>
<para>Address of frame payload or <computeroutput>NULL</computeroutput> if the entire frame content is stored in the header bytes (<emphasis>header</emphasis> and <emphasis>headerlen</emphasis>).</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">datalen</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of payload bytes to send (starting with address passed in <emphasis>data</emphasis>). Ignored if <emphasis>data</emphasis> is <computeroutput>NULL</computeroutput>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">flags</parametername>
</parameternamelist>
<parameterdescription>
<para>Optional flags<itemizedlist>
<listitem><para>XBEE_WRITE_FLAG_NONE</para></listitem></itemizedlist>
</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>0</parametername>
</parameternamelist>
<parameterdescription>
<para>Successfully queued frame in transmit serial buffer. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EINVAL</parametername>
</parameternamelist>
<parameterdescription>
<para><emphasis>xbee</emphasis> is <computeroutput>NULL</computeroutput> or invalid flags passed </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-ENODATA</parametername>
</parameternamelist>
<parameterdescription>
<para>No data to send (<emphasis>headerlen</emphasis> + <emphasis>datalen</emphasis> == 0). </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EBUSY</parametername>
</parameternamelist>
<parameterdescription>
<para>Transmit serial buffer is full, or XBee is not accepting serial data (deasserting /CTS signal). </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>-EMSGSIZE</parametername>
</parameternamelist>
<parameterdescription>
<para>Serial buffer can&apos;t ever send a frame this large.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref>, xbee_serial_write(), <ref refid="group__xbee__device_1ga75bfe1292b8af0588e0e322a42d3d2dc" kindref="member">xbee_dev_flowcontrol()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="490" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="490" bodyend="599"/>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int _xbee_frame_load</definition>
        <argsstring>(xbee_dev_t *xbee)</argsstring>
        <name>_xbee_frame_load</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <briefdescription>
<para>Check XBee&apos;s serial buffer for complete frames and pass them off to the dispatcher. </para>        </briefdescription>
        <detaileddescription>
<internal><para>Should only be called after <emphasis>xbee</emphasis> has been initialized by calling <ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref>. Typically called by <ref refid="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" kindref="member">xbee_dev_tick()</ref>.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device to read from.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>0</parametername>
</parameternamelist>
<parameterdescription>
<para>No new frames waiting. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>&gt;0</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of frames processed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>&lt;0</parametername>
</parameternamelist>
<parameterdescription>
<para>Error.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init()</ref>, <ref refid="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" kindref="member">_xbee_frame_dispatch()</ref> </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="625" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="625" bodyend="805"/>
        <references refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" compoundref="zdo_8h" startline="410">length</references>
        <references refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" compoundref="device_8h" startline="362">xbee_dev_t::serport</references>
        <references refid="group__hal__dos_1ga3c79f6b72b6cfc3cc5c4524450f661b9" compoundref="xbee__serial__dos_8c" startline="207" endline="215">xbee_ser_invalid</references>
        <referencedby refid="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" compoundref="xbee__device_8c" startline="309" endline="337">xbee_dev_tick</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gaa9c3bed7ca20dbb2cf4646811c59fe97" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void _xbee_dev_modem_status</definition>
        <argsstring>(wpan_dev_t *wpan, uint_fast8_t status)</argsstring>
        <name>_xbee_dev_modem_status</name>
        <param>
          <type><ref refid="structwpan__dev__t" kindref="compound">wpan_dev_t</ref> *</type>
          <declname>wpan</declname>
        </param>
        <param>
          <type>uint_fast8_t</type>
          <declname>status</declname>
        </param>
        <briefdescription>
<para>Receive modem status frames and update flags/state of <ref refid="structwpan__dev__t" kindref="compound">wpan_dev_t</ref>. </para>        </briefdescription>
        <detaileddescription>
<internal><para><simplesect kind="see"><para><ref refid="group__xbee__device_1ga3e6f2b540e8cec7a69ef0b0166da14ff" kindref="member">xbee_frame_handler_fn()</ref> </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="821" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="821" bodyend="859"/>
        <referencedby refid="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" compoundref="xbee__device_8c" startline="890" endline="948">_xbee_frame_dispatch</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int _xbee_frame_dispatch</definition>
        <argsstring>(xbee_dev_t *xbee, const void FAR *frame, uint16_t length)</argsstring>
        <name>_xbee_frame_dispatch</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type>const void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>frame</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>length</declname>
        </param>
        <briefdescription>
<para>Function called by <ref refid="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" kindref="member">_xbee_frame_load()</ref> to dispatch any frames read. </para>        </briefdescription>
        <detaileddescription>
<internal><para>Scans through xbee-&gt;frame_handlers, matching the frame_type and frame_id (if frame_id is not zero). Passes the frame and context (from the frame handler table) to each matching handler.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">xbee</parametername>
</parameternamelist>
<parameterdescription>
<para>XBee device that received the frames.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">frame</parametername>
</parameternamelist>
<parameterdescription>
<para>Address of bytes in frame, starting with the frame type byte. Note that the frame is still in network byte order <ndash/> it is exactly as received from the XBee module.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">length</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of bytes in frame.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Currently returns 0 in all cases. May be updated at some point with various error messages (e.g., no handlers are registered for the given frame type and ID) or the number of handlers it was dispatched to</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>-EINVAL</parametername>
</parameternamelist>
<parameterdescription>
<para>Invalid parameter </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>&gt;=0</parametername>
</parameternamelist>
<parameterdescription>
<para>number of handlers frame was dispatched to </para></parameterdescription>
</parameteritem>
</parameterlist>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="890" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="890" bodyend="948"/>
        <references refid="group__xbee__device_1gaa9c3bed7ca20dbb2cf4646811c59fe97" compoundref="xbee__device_8c" startline="821" endline="859">_xbee_dev_modem_status</references>
        <references refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" compoundref="platform_8h" startline="95">EINVAL</references>
        <references refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" compoundref="platform_8h" startline="370">FAR</references>
        <references refid="group__xbee__device_1ga8547395da056b57ba7c6b26c0c0f6ccf" compoundref="device_8h" startline="359">xbee_dev_t::wpan_dev</references>
        <references refid="group__xbee__device_1gga7753bbebaf00d6d64942f64b6ae9b7b9adff71d45371cf6b933688c43994b7f81" compoundref="device_8h" startline="82">XBEE_FRAME_MODEM_STATUS</references>
      </memberdef>
      <memberdef kind="function" id="group__xbee__device_1gae54cdc832021172ae535a449856450b7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int xbee_frame_dump_modem_status</definition>
        <argsstring>(xbee_dev_t *xbee, const void FAR *frame, uint16_t length, void FAR *context)</argsstring>
        <name>xbee_frame_dump_modem_status</name>
        <param>
          <type><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref> *</type>
          <declname>xbee</declname>
        </param>
        <param>
          <type>const void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>frame</declname>
        </param>
        <param>
          <type><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref></type>
          <declname>length</declname>
        </param>
        <param>
          <type>void <ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref> *</type>
          <declname>context</declname>
        </param>
        <briefdescription>
<para>Frame handler for 0x8A (XBEE_FRAME_MODEM_STATUS) frames <ndash/> dumps modem status to STDOUT for debugging purposes. </para>        </briefdescription>
        <detaileddescription>
<para>View the documentation of <ref refid="group__xbee__device_1ga3e6f2b540e8cec7a69ef0b0166da14ff" kindref="member">xbee_frame_handler_fn()</ref> for this function&apos;s parameters and return value.</para><para><simplesect kind="see"><para><ref refid="group__xbee__device_1gabeb9dfc3097d684df3fd9284021085f6" kindref="member">XBEE_FRAME_MODEM_STATUS_DEBUG</ref>, <ref refid="group__xbee__device_1ga3e6f2b540e8cec7a69ef0b0166da14ff" kindref="member">xbee_frame_handler_fn()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/xbee/xbee_device.c" line="956" column="1" bodyfile="src/xbee/xbee_device.c" bodystart="956" bodyend="1048"/>
        <references refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" compoundref="platform_8h" startline="95">EINVAL</references>
        <references refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" compoundref="platform_8h" startline="370">FAR</references>
        <references refid="group__xbee__wpan_1gae6f5e79770e3e599bf8154eac1a2f3fe" compoundref="wpan_8h" startline="34">payload</references>
        <references refid="group__xbee__device_1gae71297b77c0cc0dd9b75d9b27c2f781c" compoundref="device_8h" startline="553">XBEE_MODEM_STATUS_CLOUD_CONNECTED</references>
        <references refid="group__xbee__device_1ga9a85cf9201ff96546b7455758c9fd65c" compoundref="device_8h" startline="555">XBEE_MODEM_STATUS_CLOUD_DISCONNECTED</references>
        <references refid="group__xbee__device_1ga0e952a93b4cabed4b442f92ebe1b3066" compoundref="device_8h" startline="559">XBEE_MODEM_STATUS_CONFIG_CHANGE_IN_JOIN</references>
        <references refid="group__xbee__device_1ga057ed15b292ea3e48a138c6737fb0339" compoundref="device_8h" startline="543">XBEE_MODEM_STATUS_COORD_START</references>
        <references refid="group__xbee__device_1ga5a5b4041876231e1516ccd621bc298db" compoundref="device_8h" startline="539">XBEE_MODEM_STATUS_DISASSOC</references>
        <references refid="group__xbee__device_1ga28583d00e888ab4f17206ee70767aafa" compoundref="device_8h" startline="533">XBEE_MODEM_STATUS_HW_RESET</references>
        <references refid="group__xbee__device_1ga8fc9e45b59d9cd0d41c8c1afde96c0dd" compoundref="device_8h" startline="541">XBEE_MODEM_STATUS_IP_CONFIG_ERROR</references>
        <references refid="group__xbee__device_1ga2e3f5ffd01da92dd4a25257d8bc005bc" compoundref="device_8h" startline="537">XBEE_MODEM_STATUS_JOINED</references>
        <references refid="group__xbee__device_1ga190661653f541a9b694103dbd27fd284" compoundref="device_8h" startline="557">XBEE_MODEM_STATUS_KEY_ESTABLISHED</references>
        <references refid="group__xbee__device_1ga465cfa03dffba6584345938283b1c200" compoundref="device_8h" startline="545">XBEE_MODEM_STATUS_NETWORK_KEY_UPDATED</references>
        <references refid="group__xbee__device_1ga94ea3df8c78c7789b55cfa9784ee3dc4" compoundref="device_8h" startline="551">XBEE_MODEM_STATUS_OVERVOLTAGE</references>
        <references refid="group__xbee__device_1ga1a7c823908fa0c74b692665b9a76ac99" compoundref="device_8h" startline="549">XBEE_MODEM_STATUS_SLEEPING</references>
        <references refid="group__xbee__device_1gae6c193c6ae6c9ed32dc9375fdf24abcb" compoundref="device_8h" startline="561">XBEE_MODEM_STATUS_STACK_ERROR</references>
        <references refid="group__xbee__device_1gadb8d81ed3b25a11945a7a39a84255d72" compoundref="device_8h" startline="535">XBEE_MODEM_STATUS_WATCHDOG</references>
        <references refid="group__xbee__device_1gafdc21028c63554f391dc8f88e9fb82ef" compoundref="device_8h" startline="547">XBEE_MODEM_STATUS_WOKE_UP</references>
        <references refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" compoundref="platform_8h" startline="399">XBEE_UNUSED_PARAMETER</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Code related to processing XBee Frames. </para>    </briefdescription>
    <detaileddescription>
<para>Need to update xbee_send and xbee_send_endpoint to accept a callback function and context. The transmit_status message will dispatch a message to that function and callback (and then automatically delete the callback). </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2009-2013<sp/>Digi<sp/>International<sp/>Inc.,</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>All<sp/>rights<sp/>not<sp/>expressly<sp/>granted<sp/>are<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>This<sp/>Source<sp/>Code<sp/>Form<sp/>is<sp/>subject<sp/>to<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>Mozilla<sp/>Public</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>License,<sp/>v.<sp/>2.0.<sp/>If<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>MPL<sp/>was<sp/>not<sp/>distributed<sp/>with<sp/>this<sp/>file,</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>You<sp/>can<sp/>obtain<sp/>one<sp/>at<sp/>http://mozilla.org/MPL/2.0/.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>Digi<sp/>International<sp/>Inc.<sp/>11001<sp/>Bren<sp/>Road<sp/>East,<sp/>Minnetonka,<sp/>MN<sp/>55343</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>=======================================================================</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="comment">/***<sp/>BeginHeader<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="platform_8h" kindref="compound">xbee/platform.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="device_8h" kindref="compound">xbee/device.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>__DC__</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#define<sp/>_xbee_device_debug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#elif<sp/>defined<sp/>XBEE_DEVICE_DEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#define<sp/>_xbee_device_debug<sp/>__debug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#define<sp/>_xbee_device_debug<sp/>__nodebug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Load<sp/>library<sp/>for<sp/>sending<sp/>and<sp/>receiving<sp/>frames<sp/>over<sp/>serial<sp/>port.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="serial_8h" kindref="compound">xbee/serial.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="aps_8h" kindref="compound">wpan/aps.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_next_frame_id<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="60"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="61" refid="group__xbee__device_1ga9faca10d7a960dcd3c0c3ad9c0d59cab" refkind="member"><highlight class="normal"><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/><ref refid="group__xbee__device_1ga9faca10d7a960dcd3c0c3ad9c0d59cab" kindref="member">xbee_next_frame_id</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee)</highlight></codeline>
<codeline lineno="62"><highlight class="normal">{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee)</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>frame_id<sp/>ranges<sp/>from<sp/>1<sp/>to<sp/>255;<sp/>if<sp/>incremented<sp/>to<sp/>0,<sp/>wrap<sp/>to<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>++xbee-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref>)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref>;</highlight></codeline>
<codeline lineno="75"><highlight class="normal">}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_dev_init<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="113"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="114"><highlight class="comment">@note<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instead<sp/>of<sp/>passing<sp/>function<sp/>pointers,<sp/>it<sp/>may<sp/>make<sp/>more<sp/>sense<sp/>to</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>have<sp/>the<sp/>caller<sp/>set<sp/>those<sp/>elements<sp/>after<sp/>calling<sp/>xbee_dev_init.</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Unless<sp/>they<sp/>are<sp/>necessary<sp/>during<sp/>the<sp/>init<sp/>process,<sp/>there&apos;s<sp/>no<sp/>need</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>clutter<sp/>up<sp/>the<sp/>function<sp/>call<sp/>with<sp/>extra<sp/>parameters,<sp/>especially<sp/>if</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>we<sp/>need<sp/>functions<sp/>to<sp/>set<sp/>the<sp/>RTS<sp/>pin<sp/>or<sp/>read<sp/>the<sp/>CTS<sp/>pin.</highlight></codeline>
<codeline lineno="119"><highlight class="comment"></highlight></codeline>
<codeline lineno="120"><highlight class="comment">@note<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Consider<sp/>having<sp/>a<sp/>field<sp/>in<sp/>the<sp/>structure<sp/>to<sp/>indicate<sp/>when<sp/>it<sp/>has<sp/>been</highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properly<sp/>initialized,<sp/>and<sp/>have<sp/>various<sp/>functions<sp/>check<sp/>that<sp/>field</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>before<sp/>continuing.</highlight></codeline>
<codeline lineno="123"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="125" refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga550d7c865e75d3fc1df0e64cb880cf3d" kindref="member">xbee_dev_init</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structxbee__serial__t" kindref="compound">xbee_serial_t</ref><sp/>*serport,</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__xbee__device_1ga47d67ee70583d9a2a0cf7ae1eb672af8" kindref="member">xbee_is_awake_fn</ref><sp/>is_awake,<sp/><ref refid="group__xbee__device_1gaa6b2701f8516c2947424178c4bacab83" kindref="member">xbee_reset_fn</ref><sp/>reset)</highlight></codeline>
<codeline lineno="127"><highlight class="normal">{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>error;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee)</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_PLATFORM_INIT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal_1gae29ba672a9f69330a8e16a73a1a11053" kindref="member">XBEE_PLATFORM_INIT</ref>();</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>try<sp/>communicating<sp/>with<sp/>the<sp/>XBee<sp/>module</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>xbee<sp/>to<sp/>all<sp/>zeros,<sp/>then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>up<sp/>serial<sp/>port<sp/>and<sp/>attempt<sp/>communications<sp/>with<sp/>module</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/>memset(<sp/>xbee,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref>));</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>configuration<sp/>for<sp/>serial<sp/>XBee</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1gaf17bb63b8639d0278a2d0ad259865930" kindref="member">is_awake</ref><sp/>=<sp/>is_awake;<sp/></highlight><highlight class="comment">//<sp/>function<sp/>to<sp/>read<sp/>XBee&apos;s<sp/>&quot;ON&quot;<sp/>pin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(reset)</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" kindref="member">reset</ref><sp/>=<sp/>reset;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>function<sp/>to<sp/>assert<sp/>XBee&apos;s<sp/>reset<sp/>pin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>reset(<sp/>xbee,<sp/>0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>take<sp/>XBee<sp/>out<sp/>of<sp/>reset<sp/>state</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref><sp/>=<sp/>*serport;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/>error<sp/>=<sp/><ref refid="group__hal__dos_1gaa615a221dd69c17ee2989c281f2bf04a" kindref="member">xbee_ser_open</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>serport-&gt;baudrate);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>error)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>error<sp/>=<sp/><ref refid="group__hal__dos_1ga1f5f72ffdfbfb45ac523640db32296ff" kindref="member">xbee_ser_flowcontrol</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" kindref="member">XBEE_DEV_FLAG_USE_FLOWCONTROL</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_ENABLE_ATMODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fill<sp/>in<sp/>default<sp/>values<sp/>for<sp/>GT,<sp/>CT<sp/>and<sp/>CC<sp/>registers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;guard_time<sp/>=<sp/>1000;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;escape_char<sp/>=<sp/></highlight><highlight class="charliteral">&apos;+&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;idle_timeout<sp/>=<sp/>100;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>error;</highlight></codeline>
<codeline lineno="169"><highlight class="normal">}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_dev_flowcontrol<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="185"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="186" refid="group__xbee__device_1ga75bfe1292b8af0588e0e322a42d3d2dc" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga75bfe1292b8af0588e0e322a42d3d2dc" kindref="member">xbee_dev_flowcontrol</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,<sp/><ref refid="group__hal__dos_1ga04dd5074964518403bf944f2b240a5f8" kindref="member">bool_t</ref><sp/>enabled)</highlight></codeline>
<codeline lineno="187"><highlight class="normal">{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xbee<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(enabled)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>|=<sp/><ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" kindref="member">XBEE_DEV_FLAG_USE_FLOWCONTROL</ref>;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>&amp;=<sp/>~<ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" kindref="member">XBEE_DEV_FLAG_USE_FLOWCONTROL</ref>;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="199"><highlight class="normal">}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_dev_dump_settings<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ideas<sp/>for<sp/>flags:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>show<sp/>portname</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>extended<sp/>dump</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>super<sp/>dump?<sp/><sp/>(state<sp/>information)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="226" refid="group__xbee__device_1ga96267a6b36d9a1b1d59b16cc60a2b09a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga96267a6b36d9a1b1d59b16cc60a2b09a" kindref="member">xbee_dev_dump_settings</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,<sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>flags)</highlight></codeline>
<codeline lineno="227"><highlight class="normal">{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>addr[<ref refid="group__wpan__types_1gac468b40b060897498f923923654c3d4a" kindref="member">ADDR64_STRING_LENGTH</ref>];</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>flags<sp/>parameter<sp/>included<sp/>in<sp/>API<sp/>for<sp/>future<sp/>expansion;<sp/>unused<sp/>for<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>flags);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;XBee<sp/>on<sp/>%s:<sp/>HV=0x%x<sp/><sp/>VR=0x%&quot;</highlight><highlight class="normal"><sp/><ref refid="group__hal_1ga80ca66bcc9e366733f02c90ed4b0838c" kindref="member">PRIx32</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>IEEE=%&quot;</highlight><highlight class="normal"><sp/><ref refid="group__hal_1ga379022d2cd3136d8f3500c88658056b7" kindref="member">PRIsFAR</ref></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>net=0x%04x\n\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__hal__dos_1ga898057d1b7645785e7f3d6256828d039" kindref="member">xbee_ser_portname</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>),</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1gad4c7c16c071f95965e2e506752b450fe" kindref="member">hardware_version</ref>,<sp/>xbee-&gt;<ref refid="group__xbee__device_1gac8e0f35fdeff288dd1a7b4f49754c9b2" kindref="member">firmware_version</ref>,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__wpan__types_1ga448782f4aed0821758969b47221417ed" kindref="member">addr64_format</ref>(<sp/>addr,<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga8547395da056b57ba7c6b26c0c0f6ccf" kindref="member">wpan_dev</ref>.<ref refid="group__wpan__aps_1ga66a58a737aee9733019399e2eceabf4a" kindref="member">address</ref>.ieee),</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga8547395da056b57ba7c6b26c0c0f6ccf" kindref="member">wpan_dev</ref>.<ref refid="group__wpan__aps_1ga66a58a737aee9733019399e2eceabf4a" kindref="member">address</ref>.network);</highlight></codeline>
<codeline lineno="238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_dev_reset<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="254"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="255" refid="group__xbee__device_1gad312efa700cca7ca044cddf364cc51f5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gad312efa700cca7ca044cddf364cc51f5" kindref="member">xbee_dev_reset</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee)</highlight></codeline>
<codeline lineno="256"><highlight class="normal">{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>t;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee)</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee-&gt;<ref refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" kindref="member">reset</ref>)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga70979f50f9c83e5aebab3d6a1bd4cf35" kindref="member">EIO</ref>;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" kindref="member">reset</ref>(<sp/>xbee,<sp/>1);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>need<sp/>to<sp/>hold<sp/>reset<sp/>for<sp/>250ns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Wait<sp/>for<sp/>the<sp/>millisecond<sp/>timer<sp/>to<sp/>roll<sp/>over<sp/>twice<sp/>to<sp/>ensure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>250ns<sp/>elapsed.<sp/><sp/>Consider<sp/>adding<sp/>high-resolution<sp/>sleep<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>the<sp/>platform<sp/>files<sp/>(usleep?).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/>t<sp/>=<sp/><ref refid="group__hal_1ga848a9903fa7859d84cb22aeddde4c42f" kindref="member">XBEE_SET_TIMEOUT_MS</ref>(XBEE_MS_TIMER_RESOLUTION<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!<sp/><ref refid="group__hal_1gac3485c3c34a50a5a35d553cc743d163e" kindref="member">XBEE_CHECK_TIMEOUT_MS</ref>(t));</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga1f3cf44cb21be8f101d33062a9d2cf97" kindref="member">reset</ref>(<sp/>xbee,<sp/>0);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_ENABLE_ATMODE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;mode<sp/>=<sp/><ref refid="group__xbee__device_1gga5015540d81fda839a15651ddb3fb411eaf350ed60e69fcdaa6f966c76c8e6b27c" kindref="member">XBEE_MODE_UNKNOWN</ref>;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="281"><highlight class="normal">}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_dev_tick<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="308"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="309" refid="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gaf16e8e532b1eb587794b60222c3a0cce" kindref="member">xbee_dev_tick</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee)</highlight></codeline>
<codeline lineno="310"><highlight class="normal">{</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>frames;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee)</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1ga658c3ad175b50000ac44b3b9ea836d1a" kindref="member">INTERRUPT_DISABLE</ref>;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Prevent<sp/>recursion<sp/>--<sp/>_xbee_frame_load<sp/>will<sp/>dispatch<sp/>frames<sp/>as<sp/>read.<sp/><sp/>If</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>frame<sp/>handler<sp/>tries<sp/>to<sp/>call<sp/>xbee_dev_tick,<sp/>don&apos;t<sp/>recurse<sp/>into</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>_xbee_frame_load<sp/>again.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea87374abf657f1ed82b4eafdb287cbb11" kindref="member">XBEE_DEV_FLAG_IN_TICK</ref>)</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal_1gacf43057fc38f77d20456c074909ba772" kindref="member">INTERRUPT_ENABLE</ref>;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga8368025077a0385849d6817b2007c095" kindref="member">EBUSY</ref>;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>|=<sp/><ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea87374abf657f1ed82b4eafdb287cbb11" kindref="member">XBEE_DEV_FLAG_IN_TICK</ref>;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacf43057fc38f77d20456c074909ba772" kindref="member">INTERRUPT_ENABLE</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/>frames<sp/>=<sp/><ref refid="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" kindref="member">_xbee_frame_load</ref>(<sp/>xbee);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/>xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>&amp;=<sp/>~<ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea87374abf657f1ed82b4eafdb287cbb11" kindref="member">XBEE_DEV_FLAG_IN_TICK</ref>;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>frames;</highlight></codeline>
<codeline lineno="337"><highlight class="normal">}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>_xbee_dispatch_table_dump<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="349"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="350" refid="group__xbee__device_1gac7c192386ffce72242c2c8494b261491" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gac7c192386ffce72242c2c8494b261491" kindref="member">_xbee_dispatch_table_dump</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee)</highlight></codeline>
<codeline lineno="351"><highlight class="normal">{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>empty/ignored<sp/>function<sp/>unless<sp/>VERBOSE<sp/>output<sp/>enabled</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>xbee);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/>uint_fast8_t<sp/>i;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structxbee__dispatch__table__entry__t" kindref="compound">xbee_dispatch_table_entry_t</ref><sp/>*entry;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>xbee)</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/>puts(<sp/></highlight><highlight class="stringliteral">&quot;Index\tType\tID\tHandler\tContext&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/>entry<sp/>=<sp/><ref refid="group__xbee__device_1ga1a91a1dc6e99737715fbf882842872c5" kindref="member">xbee_frame_handlers</ref>;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref><sp/>!=<sp/>0xFF;<sp/>++i,<sp/>++entry)</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref>)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%3d:\t0x%02x\t0x%02x\t0x%p\t%&quot;</highlight><highlight class="normal"><sp/><ref refid="group__hal_1ga8429a3beb3448b89cb7c3877b8909369" kindref="member">PRIpFAR</ref><sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,<sp/>i,</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref>,<sp/>entry-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref>,<sp/>entry-&gt;handler,<sp/>entry-&gt;context);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%3d:\t[empty]\n&quot;</highlight><highlight class="normal">,<sp/>i);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal">}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>_xbee_checksum<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="416"><highlight class="comment">//<sp/>Function<sp/>name<sp/>in<sp/>parenthesis<sp/>so<sp/>platforms<sp/>can<sp/>provide<sp/>an<sp/>inline<sp/>assembly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight><highlight class="comment">//<sp/>version<sp/>as<sp/>a<sp/>replacement,<sp/>and<sp/>include<sp/>a<sp/>function<sp/>macro<sp/>to<sp/>override<sp/>this</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight><highlight class="comment">//<sp/>function<sp/>in<sp/>their<sp/>platform.h.<sp/><sp/>See<sp/>Rabbit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="420" refid="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" refkind="member"><highlight class="normal"><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/>(<ref refid="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" kindref="member">_xbee_checksum</ref>)(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*bytes,<sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/><ref refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" kindref="member">length</ref>,</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/>uint_fast8_t<sp/>initial)</highlight></codeline>
<codeline lineno="422"><highlight class="normal">{</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>i;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/>checksum;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*p;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/>checksum<sp/>=<sp/>initial;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)bytes,<sp/>i<sp/>=<sp/><ref refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" kindref="member">length</ref>;<sp/>i;<sp/>++p,<sp/>--i)</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>-=<sp/>*p;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>checksum;</highlight></codeline>
<codeline lineno="434"><highlight class="normal">}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_frame_write<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="487"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="byteorder_8h" kindref="compound">xbee/byteorder.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="490" refid="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga51f281b72bffcc99eec0e8c7f65a5f3f" kindref="member">xbee_frame_write</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*header,</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>headerlen,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*<ref refid="group__xbee__io_1gac5955aa1e44ff234e6d78a19cf68f25c" kindref="member">data</ref>,<sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>datalen,<sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>flags)</highlight></codeline>
<codeline lineno="492"><highlight class="normal">{</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><ref refid="group___s_x_a_1ga4233297bd31be5c273d4fb0758cc54d7" kindref="member">PACKED_STRUCT</ref><sp/>{</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/><sp/>start;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>length_be;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/>}<sp/>prefix;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cts,<sp/>free,<sp/>used,<sp/>framesize;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/>checksum<sp/>=<sp/>0xFF;</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/><ref refid="group__zcl_1ga1d127017fb298b889f4ba24752d08b8e" kindref="member">type</ref>,<sp/>id;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>debug<sp/>messages</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>flags<sp/>parameter<sp/>included<sp/>in<sp/>API<sp/>for<sp/>future<sp/>expansion;<sp/>unused<sp/>for<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>flags);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xbee<sp/>==<sp/>NULL<sp/>||<sp/><ref refid="group__hal__dos_1ga3c79f6b72b6cfc3cc5c4524450f661b9" kindref="member">xbee_ser_invalid</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>))</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>cts<sp/>=<sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xbee-&gt;<ref refid="group__xbee__device_1ga9ac684521a8154bddc272049a7a61b73" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="group__xbee__device_1gga80478d6b87ebdf34b5ec06e5ca6f309ea09be9866c594c873c75532e1dfd411b6" kindref="member">XBEE_DEV_FLAG_USE_FLOWCONTROL</ref>)</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>cts<sp/>=<sp/><ref refid="group__hal__dos_1ga894f6fadc890b5ba5ce32338f0acd217" kindref="member">xbee_ser_get_cts</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>cts<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cts<sp/>==<sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>)</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>&lt;xbee&gt;<sp/>is<sp/>NULL,<sp/>or<sp/>xbee-&gt;serport<sp/>is<sp/>not<sp/>valid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>return<sp/>-EINVAL<sp/>(xbee<sp/>=<sp/>0x%p,<sp/>cts<sp/>=<sp/>%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>xbee,<sp/>cts);</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="529"><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>header)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>headerlen<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>header<sp/>is<sp/>NULL,<sp/>set<sp/>headerlen<sp/>to<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>data)</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>datalen<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>data<sp/>is<sp/>NULL,<sp/>set<sp/>datalen<sp/>to<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>(headerlen<sp/>||<sp/>datalen))</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>return<sp/>-ENODATA<sp/>(headerlen<sp/>=<sp/>%u,<sp/>datalen<sp/>=<sp/>%u)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>headerlen,<sp/>datalen);</highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga0030614bc864d1b24eaedd71585acc27" kindref="member">ENODATA</ref>;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>XBee<sp/>is<sp/>asserting<sp/>CTS<sp/>and<sp/>verify<sp/>that<sp/>the<sp/>transmit<sp/>serial<sp/>buffer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>has<sp/>enough<sp/>room<sp/>for<sp/>the<sp/>frame<sp/>(payload<sp/>+<sp/>3-byte<sp/>header<sp/>+<sp/>1-byte<sp/>checksum).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/>free<sp/>=<sp/><ref refid="group__hal__dos_1ga3ad8f378b572d6fec982f1086bd3b94f" kindref="member">xbee_ser_tx_free</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/>used<sp/>=<sp/><ref refid="group__hal__dos_1gaabf70934d186354cde4ac14ed27d1bd2" kindref="member">xbee_ser_tx_used</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>);</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/>framesize<sp/>=<sp/>headerlen<sp/>+<sp/>datalen<sp/>+<sp/>3<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>cts<sp/>||<sp/>free<sp/>&lt;<sp/>framesize)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>return<sp/>-EBUSY<sp/>(cts<sp/>=<sp/>%s,<sp/>free<sp/>=<sp/>%d,<sp/>framesize<sp/>=<sp/>%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>cts<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;yes&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;no&quot;</highlight><highlight class="normal">,<sp/>free,<sp/>framesize);</highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(framesize<sp/>-<sp/>free<sp/>&gt;<sp/>used)<sp/>?<sp/>-<ref refid="group__hal_1gae37becfaa095a9df5c5c788bce5aa06f" kindref="member">EMSGSIZE</ref><sp/>:<sp/>-<ref refid="group__hal_1ga8368025077a0385849d6817b2007c095" kindref="member">EBUSY</ref>;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>type<sp/>=<sp/>*(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)<sp/>(headerlen<sp/>?<sp/>header<sp/>:<sp/>data);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(headerlen<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>headerlen<sp/>is<sp/>1,<sp/>id<sp/>is<sp/>first<sp/>byte<sp/>of<sp/>data,<sp/>otherwise<sp/>second<sp/>byte</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>=<sp/>((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)data)[headerlen<sp/>?<sp/>0<sp/>:<sp/>1];</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>=<sp/>((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)header)[1];</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>frame<sp/>type<sp/>0x%02x,<sp/>id<sp/>0x%02x<sp/>(%u-byte<sp/>payload)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>type,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>headerlen<sp/>+<sp/>datalen);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Send<sp/>0x7E<sp/>(start<sp/>frame<sp/>marker)<sp/>and<sp/>16-bit<sp/>length</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/>prefix.start<sp/>=<sp/>0x7E;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/>prefix.length_be<sp/>=<sp/><ref refid="group__util__byteorder_1ga4b9167199621b390f82c3e5361ba6df6" kindref="member">htobe16</ref>(<sp/>headerlen<sp/>+<sp/>datalen);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga2ca4e60c9d642084afa52dff9e1f6be4" kindref="member">xbee_ser_write</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>&amp;prefix,<sp/>3);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Send<sp/>&lt;headerlen&gt;<sp/>bytes<sp/>from<sp/>&lt;header&gt;<sp/>if<sp/>it<sp/>is<sp/>not<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(headerlen)</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal__dos_1ga2ca4e60c9d642084afa52dff9e1f6be4" kindref="member">xbee_ser_write</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>header,<sp/>headerlen);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>=<sp/><ref refid="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" kindref="member">_xbee_checksum</ref>(<sp/>header,<sp/>headerlen,<sp/>checksum);</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Send<sp/>&lt;datalen&gt;<sp/>bytes<sp/>from<sp/>&lt;data&gt;<sp/>if<sp/>it<sp/>is<sp/>not<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(datalen)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal__dos_1ga2ca4e60c9d642084afa52dff9e1f6be4" kindref="member">xbee_ser_write</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>data,<sp/>datalen);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>=<sp/><ref refid="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" kindref="member">_xbee_checksum</ref>(<sp/>data,<sp/>datalen,<sp/>checksum);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Send<sp/>1-byte<sp/>checksum<sp/>of<sp/>bytes<sp/>in<sp/>payload</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga2ca4e60c9d642084afa52dff9e1f6be4" kindref="member">xbee_ser_write</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>,<sp/>&amp;checksum,<sp/>1);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="599"><highlight class="normal">}</highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>_xbee_frame_load<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__XBEE_PLATFORM_HCS08</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#pragma<sp/>MESSAGE<sp/>DISABLE<sp/>C5909<sp/><sp/><sp/><sp/>//<sp/>Assignment<sp/>in<sp/>condition<sp/>is<sp/>OK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="625" refid="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gac0874f9422c6588062a4b6205e989fc6" kindref="member">_xbee_frame_load</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee)</highlight></codeline>
<codeline lineno="626"><highlight class="normal">{</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>xbee_serial<sp/>API<sp/>to<sp/>load<sp/>multiple<sp/>bytes<sp/>at<sp/>a<sp/>time.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Based<sp/>on<sp/>state,<sp/>do<sp/>one<sp/>of<sp/>the<sp/>following:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>1)<sp/>Waiting<sp/>for<sp/>start<sp/>of<sp/>frame:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Scan<sp/>through<sp/>serial<sp/>buffer<sp/>until<sp/>0x7e<sp/>byte<sp/>is<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Advance<sp/>to<sp/>next<sp/>state.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>2)<sp/>Waiting<sp/>for<sp/>length:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Wait<sp/>until<sp/>2<sp/>bytes<sp/>in<sp/>serial<sp/>buffer,<sp/>read<sp/>into<sp/>xbee-&gt;rx.bytes_in_frame.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>3)<sp/>Waiting<sp/>for<sp/>(&lt;length&gt;<sp/>+<sp/>1)<sp/>bytes<sp/>of<sp/>data:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Read<sp/>as<sp/>many<sp/>bytes<sp/>as<sp/>possible<sp/>from<sp/>the<sp/>serial<sp/>buffer<sp/>and<sp/>into<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>xbee-&gt;rx.frame_data[].<sp/><sp/>Once<sp/>all<sp/>bytes<sp/>have<sp/>been<sp/>read,<sp/>calculate<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>verify<sp/>checksum<sp/>and<sp/>then<sp/>hand<sp/>off<sp/>to<sp/>dispatcher.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/>ch;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/><ref refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" kindref="member">length</ref>;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>retval;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bytes_left,<sp/>read;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/>uint_fast8_t<sp/>dispatched;</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><ref refid="structxbee__serial__t" kindref="compound">xbee_serial_t</ref><sp/><sp/>*serport;</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xbee<sp/>==<sp/>NULL<sp/>||<sp/><ref refid="group__hal__dos_1ga3c79f6b72b6cfc3cc5c4524450f661b9" kindref="member">xbee_ser_invalid</ref>(<sp/>(serport<sp/>=<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga3145a7888ffabfc3f10e8e85ced0c686" kindref="member">serport</ref>)<sp/>))</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>return<sp/>-EINVAL<sp/>(xbee<sp/>is<sp/>%p)\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>xbee);</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/>dispatched<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>counter<sp/>to<sp/>keep<sp/>track<sp/>of<sp/>frames<sp/>processed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;;)</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref>)</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae0a149adbaecdd2c5d84a1ed006e01a3" kindref="member">XBEE_RX_STATE_WAITSTART</ref>:<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>waiting<sp/>for<sp/>initial<sp/>0x7E</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="666"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It<sp/>may<sp/>seem<sp/>inefficient<sp/>to<sp/>read<sp/>one<sp/>byte<sp/>at<sp/>a<sp/>time<sp/>while<sp/>looking</highlight></codeline>
<codeline lineno="667"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>0x7E<sp/>start<sp/>byte,<sp/>but<sp/>in<sp/>reality<sp/>we<sp/>almost<sp/>always<sp/>read<sp/>it</highlight></codeline>
<codeline lineno="668"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>on<sp/>the<sp/>first<sp/>attempt<sp/>(i.e.,<sp/>the<sp/>buffer<sp/>should<sp/>be<sp/>empty<sp/>or<sp/>will</highlight></codeline>
<codeline lineno="669"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>start<sp/>with<sp/>0x7E).</highlight></codeline>
<codeline lineno="670"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retval<sp/>=<sp/><ref refid="group__hal__dos_1ga8263312373c03a79a718142e051b3342" kindref="member">xbee_ser_read</ref>(<sp/>serport,<sp/>&amp;ch,<sp/>1);</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(retval<sp/>!=<sp/>1)</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(ch<sp/>!=<sp/>0x7E);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>got<sp/>start-of-frame\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__);</highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09dea641dccc2bf7a54d9108a7d3a1aa94dfc" kindref="member">XBEE_RX_STATE_LENGTH_MSB</ref>;</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fall<sp/>through<sp/>to<sp/>next<sp/>state</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09dea641dccc2bf7a54d9108a7d3a1aa94dfc" kindref="member">XBEE_RX_STATE_LENGTH_MSB</ref>:</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>try<sp/>to<sp/>read<sp/>a<sp/>character<sp/>from<sp/>the<sp/>serial<sp/>port</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__hal__dos_1ga8263312373c03a79a718142e051b3342" kindref="member">xbee_ser_read</ref>(<sp/>serport,<sp/>&amp;ch,<sp/>1)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ch<sp/>==<sp/>0x7E)</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MSB<sp/>of<sp/>length<sp/>can<sp/>never<sp/>be<sp/>0x7E,<sp/>consider<sp/>it<sp/>to<sp/>be<sp/>the<sp/>new</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>start-of-frame<sp/>character<sp/>and<sp/>recheck<sp/>for<sp/>the<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>ignoring<sp/>duplicate<sp/>start-of-frame<sp/>(0x7E)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>MSB<sp/>of<sp/>frame<sp/>length</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref><sp/>=<sp/>ch<sp/>&lt;&lt;<sp/>8;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deafc90aadcdd6ea17637198aadd9d85efd" kindref="member">XBEE_RX_STATE_LENGTH_LSB</ref>;</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fall<sp/>through<sp/>to<sp/>trying<sp/>to<sp/>read<sp/>LSB<sp/>of<sp/>length</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deafc90aadcdd6ea17637198aadd9d85efd" kindref="member">XBEE_RX_STATE_LENGTH_LSB</ref>:</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>try<sp/>to<sp/>read<sp/>a<sp/>character<sp/>from<sp/>the<sp/>serial<sp/>port</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__hal__dos_1ga8263312373c03a79a718142e051b3342" kindref="member">xbee_ser_read</ref>(<sp/>serport,<sp/>&amp;ch,<sp/>1)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>LSB<sp/>of<sp/>frame<sp/>length,<sp/>make<sp/>local<sp/>copy<sp/>for<sp/>range<sp/>check</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/>(xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref><sp/>+=<sp/>ch);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(length<sp/>&gt;<sp/><ref refid="group__xbee__device_1gaefbbf0c7c5b7560f7137e5ff2cab4e45" kindref="member">XBEE_MAX_RX_FRAME_LEN</ref><sp/>||<sp/>length<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>isn&apos;t<sp/>a<sp/>valid<sp/>frame,<sp/>go<sp/>back<sp/>to<sp/>looking<sp/>for<sp/>start<sp/>marker</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>read<sp/>bad<sp/>frame<sp/>length<sp/>(%u<sp/>!<sp/>[2<sp/>..<sp/>%u])\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>length,<sp/><ref refid="group__xbee__device_1gaefbbf0c7c5b7560f7137e5ff2cab4e45" kindref="member">XBEE_MAX_RX_FRAME_LEN</ref>);</highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ch<sp/>==<sp/>0x7E)</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handle<sp/>case<sp/>of<sp/>0x7E<sp/>0xXX<sp/>0x7E<sp/>where<sp/>second<sp/>0x7E<sp/>is<sp/>actual</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>start<sp/>of<sp/>frame.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09dea641dccc2bf7a54d9108a7d3a1aa94dfc" kindref="member">XBEE_RX_STATE_LENGTH_MSB</ref>;</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae0a149adbaecdd2c5d84a1ed006e01a3" kindref="member">XBEE_RX_STATE_WAITSTART</ref>;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>got<sp/>length<sp/>%&quot;</highlight><highlight class="normal"><sp/><ref refid="group__hal_1ga86bc00ee87e8e40787e0681fc34c576a" kindref="member">PRIu16</ref><sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>length);</highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae7792cb93b09dde7b061947daffcb35a" kindref="member">XBEE_RX_STATE_RXFRAME</ref>;</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gad7b2ae5814cb8706ab662a5d67e4837a" kindref="member">bytes_read</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fall<sp/>through<sp/>to<sp/>next<sp/>state</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae7792cb93b09dde7b061947daffcb35a" kindref="member">XBEE_RX_STATE_RXFRAME</ref>:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>receiving<sp/>frame<sp/>&amp;<sp/>trailing<sp/>checksum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bytes_left<sp/>=<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref><sp/>-<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gad7b2ae5814cb8706ab662a5d67e4837a" kindref="member">bytes_read</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>read<sp/>=<sp/><ref refid="group__hal__dos_1ga8263312373c03a79a718142e051b3342" kindref="member">xbee_ser_read</ref>(<sp/>serport,</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gaa172073584adf9e2f74034489f9cd2a4" kindref="member">frame_data</ref><sp/>+<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gad7b2ae5814cb8706ab662a5d67e4837a" kindref="member">bytes_read</ref>,<sp/>bytes_left);</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(read<sp/>!=<sp/>bytes_left)</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Not<sp/>enough<sp/>bytes<sp/>to<sp/>finish<sp/>reading<sp/>current<sp/>frame,<sp/>record</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>bytes<sp/>read<sp/>and<sp/>return.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(read<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gad7b2ae5814cb8706ab662a5d67e4837a" kindref="member">bytes_read</ref><sp/>+=<sp/>read;</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ready<sp/>to<sp/>load<sp/>more<sp/>frames<sp/>on<sp/>next<sp/>pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae0a149adbaecdd2c5d84a1ed006e01a3" kindref="member">XBEE_RX_STATE_WAITSTART</ref>;</highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__xbee__device_1gae8a32665036083d3a236fcde4359cc79" kindref="member">_xbee_checksum</ref>(<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gaa172073584adf9e2f74034489f9cd2a4" kindref="member">frame_data</ref>,</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref><sp/>+<sp/>1,<sp/>0xFF))</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>checksum<sp/>failed,<sp/>throw<sp/>out<sp/>the<sp/>frame</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>checksum<sp/>failed\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__);</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__util_1gaa321236a0cb6f4e0dad592fdf1b550d2" kindref="member">hex_dump</ref>(<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gaa172073584adf9e2f74034489f9cd2a4" kindref="member">frame_data</ref>,<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref><sp/>+<sp/>1,</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal_1gaec79525addd1a70fda55b1ea11534832" kindref="member">HEX_DUMP_FLAG_OFFSET</ref>);</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>At<sp/>this<sp/>point,<sp/>we<sp/>*could*<sp/>look<sp/>through<sp/>the<sp/>frame<sp/>data<sp/>for</highlight></codeline>
<codeline lineno="768"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>another<sp/>start-of-frame<sp/>(0x7E)<sp/>marker,<sp/>including<sp/>considering</highlight></codeline>
<codeline lineno="769"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>LSB<sp/>of<sp/>the<sp/>length<sp/>field.<sp/><sp/>We<sp/>shouldn&apos;t<sp/>have<sp/>to<sp/>though<sp/>--</highlight></codeline>
<codeline lineno="770"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assuming<sp/>a<sp/>good<sp/>serial<sp/>connection,<sp/>we<sp/>should<sp/>stay<sp/>in<sp/>sync</highlight></codeline>
<codeline lineno="771"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>XBee<sp/>frames<sp/>and<sp/>not<sp/>have<sp/>to<sp/>work<sp/>too<sp/>hard<sp/>at<sp/>resyncing.</highlight></codeline>
<codeline lineno="772"><highlight class="comment"></highlight></codeline>
<codeline lineno="773"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Also,<sp/>we<sp/>only<sp/>sync<sp/>to<sp/>a<sp/>select<sp/>range<sp/>of<sp/>3-byte<sp/>sequences<sp/>--</highlight></codeline>
<codeline lineno="774"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x7E<sp/>followed<sp/>by<sp/>two-byte<sp/>length<sp/>of<sp/>0<sp/>to<sp/>about<sp/>300.</highlight></codeline>
<codeline lineno="775"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>frame<sp/>is<sp/>ready<sp/>for<sp/>dispatch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++dispatched;</highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>dispatch<sp/>frame<sp/>#%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispatched);</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" kindref="member">_xbee_frame_dispatch</ref>(<sp/>xbee,<sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1gaa172073584adf9e2f74034489f9cd2a4" kindref="member">frame_data</ref>,</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga1048ca0eb1adc5759a0df48ae8ae740a" kindref="member">bytes_in_frame</ref>);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dispatched<sp/>==<sp/><ref refid="group__xbee__device_1gaeaab23929fe74420e519d21bba8008e6" kindref="member">XBEE_DEV_MAX_DISPATCH_PER_TICK</ref>)</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>invalid<sp/>state<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xbee-&gt;rx.<ref refid="group__xbee__device_1ga758a79cfaf819f091728c06474466321" kindref="member">state</ref><sp/>=<sp/><ref refid="group__xbee__device_1gga30374ada0aff261c5da7557882fd09deae0a149adbaecdd2c5d84a1ed006e01a3" kindref="member">XBEE_RX_STATE_WAITSTART</ref>;</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="805"><highlight class="normal">}</highlight></codeline>
<codeline lineno="806"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__XBEE_PLATFORM_HCS08</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#pragma<sp/>MESSAGE<sp/>DEFAULT<sp/>C5909<sp/><sp/><sp/><sp/>//<sp/>restore<sp/>C5909<sp/>(Assignment<sp/>in<sp/>condition)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809"><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>_xbee_frame_dispatch<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight></codeline>
<codeline lineno="820"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="821" refid="group__xbee__device_1gaa9c3bed7ca20dbb2cf4646811c59fe97" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gaa9c3bed7ca20dbb2cf4646811c59fe97" kindref="member">_xbee_dev_modem_status</ref>(<sp/><ref refid="structwpan__dev__t" kindref="compound">wpan_dev_t</ref><sp/>*wpan,<sp/>uint_fast8_t<sp/><ref refid="group__xbee__atcmd_1gade818037fd6c985038ff29656089758d" kindref="member">status</ref>)</highlight></codeline>
<codeline lineno="822"><highlight class="normal">{</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/>flags<sp/>=<sp/>wpan-&gt;<ref refid="group__wpan__aps_1ga1e87af3c18a2fd36c61faf89949bdc3f" kindref="member">flags</ref>;</highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(status)</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga057ed15b292ea3e48a138c6737fb0339" kindref="member">XBEE_MODEM_STATUS_COORD_START</ref>:</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We&apos;re<sp/>the<sp/>coordinator,<sp/>so<sp/>we<sp/>know<sp/>our<sp/>network<sp/>address<sp/>and<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>implicitly<sp/>joined.<sp/><sp/>If<sp/>EO<sp/>is<sp/>non-zero<sp/>(which<sp/>we<sp/>aren&apos;t<sp/>checking)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>then<sp/>we&apos;re<sp/>authenticated<sp/>as<sp/>well.<sp/><sp/>Maybe<sp/>add<sp/>an<sp/>EE<sp/>check<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>xbee_cmd_query_device<sp/>and<sp/>set<sp/>another<sp/>flag?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wpan-&gt;<ref refid="group__wpan__aps_1ga66a58a737aee9733019399e2eceabf4a" kindref="member">address</ref>.network<sp/>=<sp/><ref refid="group__wpan__types_1ga5158cbab6c4139bd77d1d3f80d9071b2" kindref="member">WPAN_NET_ADDR_COORDINATOR</ref>;</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>(<ref refid="group__wpan__aps_1gaa06c0d38b4a130f9657abf26c73b49dd" kindref="member">WPAN_FLAG_JOINED</ref><sp/>|<sp/><ref refid="group__wpan__aps_1ga6508b417838fc0a043f5570b65e3f24b" kindref="member">WPAN_FLAG_AUTHENTICATED</ref>);</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga190661653f541a9b694103dbd27fd284" kindref="member">XBEE_MODEM_STATUS_KEY_ESTABLISHED</ref>:</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/><ref refid="group__wpan__aps_1ga6508b417838fc0a043f5570b65e3f24b" kindref="member">WPAN_FLAG_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>It&apos;s<sp/>possible<sp/>to<sp/>go<sp/>straight<sp/>to<sp/>Key<sp/>Established<sp/>from<sp/>a<sp/>watchdog</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>timeout,<sp/>so<sp/>fall<sp/>through<sp/>to<sp/>the<sp/>JOINED<sp/>status<sp/>as<sp/>well.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga2e3f5ffd01da92dd4a25257d8bc005bc" kindref="member">XBEE_MODEM_STATUS_JOINED</ref>:</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/><ref refid="group__wpan__aps_1gaa06c0d38b4a130f9657abf26c73b49dd" kindref="member">WPAN_FLAG_JOINED</ref>;</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="844"><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga28583d00e888ab4f17206ee70767aafa" kindref="member">XBEE_MODEM_STATUS_HW_RESET</ref>:</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gadb8d81ed3b25a11945a7a39a84255d72" kindref="member">XBEE_MODEM_STATUS_WATCHDOG</ref>:</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga5a5b4041876231e1516ccd621bc298db" kindref="member">XBEE_MODEM_STATUS_DISASSOC</ref>:</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>longer<sp/>joined<sp/>or<sp/>authenticated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>&amp;=<sp/>~(<ref refid="group__wpan__aps_1gaa06c0d38b4a130f9657abf26c73b49dd" kindref="member">WPAN_FLAG_JOINED</ref><sp/>|<sp/><ref refid="group__wpan__aps_1ga6508b417838fc0a043f5570b65e3f24b" kindref="member">WPAN_FLAG_AUTHENTICATED</ref>);</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wpan-&gt;<ref refid="group__wpan__aps_1ga66a58a737aee9733019399e2eceabf4a" kindref="member">address</ref>.network<sp/>=<sp/><ref refid="group__wpan__types_1ga1674d7b825e528a482725d1c06b02c10" kindref="member">WPAN_NET_ADDR_UNDEFINED</ref>;</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>marked<sp/>network<sp/>address<sp/>as<sp/>invalid<sp/>(status=0x%02x)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>status);</highlight></codeline>
<codeline lineno="854"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="857"><highlight class="normal"></highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/>wpan-&gt;<ref refid="group__wpan__aps_1ga1e87af3c18a2fd36c61faf89949bdc3f" kindref="member">flags</ref><sp/>=<sp/>flags;</highlight></codeline>
<codeline lineno="859"><highlight class="normal">}</highlight></codeline>
<codeline lineno="860"><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="890" refid="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gab386cd9e1afe784ab79b3139fe8fc5c8" kindref="member">_xbee_frame_dispatch</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*frame,</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/><ref refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" kindref="member">length</ref>)</highlight></codeline>
<codeline lineno="892"><highlight class="normal">{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/>uint_fast8_t<sp/>frametype,<sp/>frameid;</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal__dos_1ga04dd5074964518403bf944f2b240a5f8" kindref="member">bool_t</ref><sp/>dispatched;</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structxbee__dispatch__table__entry__t" kindref="compound">xbee_dispatch_table_entry_t</ref><sp/>*entry;</highlight></codeline>
<codeline lineno="896"><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>(xbee<sp/>&amp;&amp;<sp/>frame<sp/>&amp;&amp;<sp/>length))</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Since<sp/>this<sp/>is<sp/>an<sp/>internal<sp/>API,<sp/>always<sp/>called<sp/>correctly,<sp/>this<sp/>should</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>not<sp/>happen<sp/>and<sp/>could<sp/>be<sp/>changed<sp/>to<sp/>an<sp/>assert.<sp/><sp/>Currently<sp/>part<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>unit<sp/>tests<sp/>for<sp/>this<sp/>module.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>first<sp/>byte<sp/>of<sp/>&lt;frame&gt;<sp/>is<sp/>the<sp/>frametype,<sp/>second<sp/>is<sp/>frame<sp/>ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/>frametype<sp/>=<sp/>((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)frame)[0];</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/>frameid<sp/>=<sp/>((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="group__hal__dos_1gae1affc9ca37cfb624959c866a73f83c2" kindref="member">uint8_t</ref><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*)frame)[1];</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(frametype<sp/>==<sp/><ref refid="group__xbee__device_1gga7753bbebaf00d6d64942f64b6ae9b7b9adff71d45371cf6b933688c43994b7f81" kindref="member">XBEE_FRAME_MODEM_STATUS</ref>)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__xbee__device_1gaa9c3bed7ca20dbb2cf4646811c59fe97" kindref="member">_xbee_dev_modem_status</ref>(<sp/>&amp;xbee-&gt;<ref refid="group__xbee__device_1ga8547395da056b57ba7c6b26c0c0f6ccf" kindref="member">wpan_dev</ref>,<sp/>frameid);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>dispatch<sp/>frame<sp/>type<sp/>0x%02x,<sp/>id<sp/>0x%02x\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>frametype,<sp/>frameid);</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__util_1gaa321236a0cb6f4e0dad592fdf1b550d2" kindref="member">hex_dump</ref>(<sp/>frame,<sp/>length,<sp/><ref refid="group__hal_1gae60f842ae8bc3cc952cdeece611670d5" kindref="member">HEX_DUMP_FLAG_NONE</ref>);</highlight></codeline>
<codeline lineno="918"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"></highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/>dispatched<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(entry<sp/>=<sp/><ref refid="group__xbee__device_1ga1a91a1dc6e99737715fbf882842872c5" kindref="member">xbee_frame_handlers</ref>;<sp/>entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref><sp/>!=<sp/>0xFF;<sp/>++entry)</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref><sp/>||<sp/>entry-&gt;<ref refid="group__xbee__device_1gafa34d393db5fa915716b483011415ddc" kindref="member">frame_type</ref><sp/>==<sp/>frametype)</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>entry<sp/>matches<sp/>all<sp/>frame<sp/>types<sp/>(0)<sp/>or<sp/>matches<sp/>this<sp/>frame&apos;s<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>entry-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref><sp/>||<sp/>entry-&gt;<ref refid="group__xbee__device_1ga03c1016ac46b9df250b994f242cf956a" kindref="member">frame_id</ref><sp/>==<sp/>frameid)</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++dispatched;</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>entry<sp/>matches<sp/>all<sp/>frame<sp/>IDs<sp/>(0)<sp/>or<sp/>matches<sp/>this<sp/>frame&apos;s<sp/>ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>calling<sp/>frame<sp/>handler<sp/>@%p,<sp/>w/context<sp/>%&quot;</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hal_1ga8429a3beb3448b89cb7c3877b8909369" kindref="member">PRIpFAR</ref><sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,<sp/>entry-&gt;handler,<sp/>entry-&gt;context);</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>entry-&gt;handler(<sp/>xbee,<sp/>frame,<sp/>length,<sp/>entry-&gt;context);</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#ifdef<sp/>XBEE_DEVICE_VERBOSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>dispatched)</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>no<sp/>handlers<sp/>for<sp/>frame<sp/>type<sp/>0x%02x,<sp/>id<sp/>0x%02x\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__FUNCTION__,<sp/>frametype,<sp/>frameid);</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="945"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dispatched;</highlight></codeline>
<codeline lineno="948"><highlight class="normal">}</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>BeginHeader<sp/>xbee_frame_dump_modem_status<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight><highlight class="comment">/***<sp/>EndHeader<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight><highlight class="comment">//<sp/>see<sp/>xbee/device.h<sp/>for<sp/>documentation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal">_xbee_device_debug</highlight></codeline>
<codeline lineno="956" refid="group__xbee__device_1gae54cdc832021172ae535a449856450b7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gae54cdc832021172ae535a449856450b7" kindref="member">xbee_frame_dump_modem_status</ref>(<sp/><ref refid="structxbee__dev__t" kindref="compound">xbee_dev_t</ref><sp/>*xbee,</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*<ref refid="group__xbee__wpan_1gae6f5e79770e3e599bf8154eac1a2f3fe" kindref="member">payload</ref>,<sp/><ref refid="group__hal__dos_1ga5a8b2dc9e45a9ee81a94ef304fb62505" kindref="member">uint16_t</ref><sp/><ref refid="group__zdo_1gab2b3adeb2a67e656ff030b56727fd0ac" kindref="member">length</ref>,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*context)</highlight></codeline>
<codeline lineno="958"><highlight class="normal">{</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>xbee_frame_modem_status_t<sp/><ref refid="group__hal_1gaef060b3456fdcc093a7210a762d5f2ed" kindref="member">FAR</ref><sp/>*frame<sp/>=<sp/><ref refid="group__xbee__wpan_1gae6f5e79770e3e599bf8154eac1a2f3fe" kindref="member">payload</ref>;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*status_str;</highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Standard<sp/>frame<sp/>handler<sp/>callback<sp/>API,<sp/>but<sp/>we<sp/>only<sp/>care<sp/>about<sp/>payload.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>xbee);</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>length);</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><ref refid="group__hal_1gacddb73dac3fd1bdec26cd7dc0a652c00" kindref="member">XBEE_UNUSED_PARAMETER</ref>(<sp/>context);</highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stack<sp/>will<sp/>never<sp/>call<sp/>us<sp/>with<sp/>a<sp/>NULL<sp/>frame,<sp/>but<sp/>user<sp/>code<sp/>might</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(frame<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__hal_1ga2d1678d5a7cc8ce499643f3b8957def4" kindref="member">EINVAL</ref>;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="972"><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Instead<sp/>of<sp/>updating<sp/>this<sp/>lib<sp/>to<sp/>trigger<sp/>changes<sp/>in<sp/>other<sp/>layers<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>API,<sp/>other<sp/>libraries<sp/>should<sp/>register<sp/>to<sp/>receive<sp/>modem<sp/>status<sp/>events</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>directly.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"></highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(frame-&gt;status)</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga28583d00e888ab4f17206ee70767aafa" kindref="member">XBEE_MODEM_STATUS_HW_RESET</ref>:</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;hardware<sp/>reset&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="982"><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gadb8d81ed3b25a11945a7a39a84255d72" kindref="member">XBEE_MODEM_STATUS_WATCHDOG</ref>:</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;watchdog<sp/>timeout&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga2e3f5ffd01da92dd4a25257d8bc005bc" kindref="member">XBEE_MODEM_STATUS_JOINED</ref>:</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;joined&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="990"><highlight class="normal"></highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga5a5b4041876231e1516ccd621bc298db" kindref="member">XBEE_MODEM_STATUS_DISASSOC</ref>:</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;disassociated&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="994"><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>XBEE_WIFI_ENABLED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga8fc9e45b59d9cd0d41c8c1afde96c0dd" kindref="member">XBEE_MODEM_STATUS_IP_CONFIG_ERROR</ref>:</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;IP<sp/>config<sp/>error&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="999"><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gae71297b77c0cc0dd9b75d9b27c2f781c" kindref="member">XBEE_MODEM_STATUS_CLOUD_CONNECTED</ref>:</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Device<sp/>Cloud<sp/>connected&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga9a85cf9201ff96546b7455758c9fd65c" kindref="member">XBEE_MODEM_STATUS_CLOUD_DISCONNECTED</ref>:</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Device<sp/>Cloud<sp/>disconnected&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga057ed15b292ea3e48a138c6737fb0339" kindref="member">XBEE_MODEM_STATUS_COORD_START</ref>:</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;coordinator<sp/>started&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga465cfa03dffba6584345938283b1c200" kindref="member">XBEE_MODEM_STATUS_NETWORK_KEY_UPDATED</ref>:</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;key<sp/>updated&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga94ea3df8c78c7789b55cfa9784ee3dc4" kindref="member">XBEE_MODEM_STATUS_OVERVOLTAGE</ref>:</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;overvoltage&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gafdc21028c63554f391dc8f88e9fb82ef" kindref="member">XBEE_MODEM_STATUS_WOKE_UP</ref>:</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;woke<sp/>up&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga1a7c823908fa0c74b692665b9a76ac99" kindref="member">XBEE_MODEM_STATUS_SLEEPING</ref>:</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;sleeping&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga190661653f541a9b694103dbd27fd284" kindref="member">XBEE_MODEM_STATUS_KEY_ESTABLISHED</ref>:</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;key<sp/>established&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1ga0e952a93b4cabed4b442f92ebe1b3066" kindref="member">XBEE_MODEM_STATUS_CONFIG_CHANGE_IN_JOIN</ref>:</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;config<sp/>change<sp/>during<sp/>join&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="group__xbee__device_1gae6c193c6ae6c9ed32dc9375fdf24abcb" kindref="member">XBEE_MODEM_STATUS_STACK_ERROR</ref>:</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;stack<sp/>error&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;undefined&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/>printf(<sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>status:<sp/>%s<sp/>(0x%02x)\n&quot;</highlight><highlight class="normal">,<sp/>__FUNCTION__,</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>status_str,<sp/>frame-&gt;status);</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1048"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/xbee/xbee_device.c"/>
  </compounddef>
</doxygen>
