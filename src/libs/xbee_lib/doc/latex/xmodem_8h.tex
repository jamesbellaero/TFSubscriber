\hypertarget{xmodem_8h}{}\section{include/xbee/xmodem.h File Reference}
\label{xmodem_8h}\index{include/xbee/xmodem.\+h@{include/xbee/xmodem.\+h}}


Xmodem A\+PI used with firmware updates.  


{\ttfamily \#include \char`\"{}xbee/platform.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}xbee/device.\+h\char`\"{}}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t}
\begin{DoxyCompactList}\small\item\em Structure used to track the state of an Xmodem send. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef int($\ast$ \hyperlink{group__util__xmodem_ga25f49dbd4c2f9e274a32217a709d6382}{xbee\+\_\+xmodem\+\_\+read\+\_\+fn}) (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$context, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$buffer, \hyperlink{group__hal__dos_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\+\_\+t} bytes)
\begin{DoxyCompactList}\small\item\em Function to assign to {\ttfamily file.\+read} or {\ttfamily stream.\+read} member of an \hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} object. \end{DoxyCompactList}\item 
typedef int($\ast$ \hyperlink{group__util__xmodem_ga57f329cc7f4e1b18f5baddb888221d7f}{xbee\+\_\+xmodem\+\_\+write\+\_\+fn}) (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$context, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$buffer, \hyperlink{group__hal__dos_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\+\_\+t} bytes)
\begin{DoxyCompactList}\small\item\em Function to assign to {\ttfamily stream.\+write} member of an \hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__util__xmodem_gaca3fc49d80cd9afccc34812b2985484f}{xbee\+\_\+xmodem\+\_\+state} \{ \newline
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fa0a84e83220282fadef6bcee5b42fd02f}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+F\+L\+U\+SH}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fa35f508b4cdce4d950e327aa7fe73e9df}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+T\+A\+RT}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fa53ac0249ccdeb684c78baee336d65187}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+ND}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484facb6bc4306d97a0b11b1ad879725df3b5}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+E\+ND}, 
\newline
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fac9e012359b6cf5f45ea6f2f5f9d76d4d}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+NG}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fad7ce55b9d8ec65fa4f8410590cb67eaa}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+W\+A\+I\+T\+\_\+\+A\+CK}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fac0f165be362c1a05448acb718d15299c}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+E\+OF}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fae1a85fb72853aa9b4b2b1ef7734315a4}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+F\+I\+N\+A\+L\+\_\+\+A\+CK}, 
\newline
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484fac17280139c0e7d88f3c6371bda3f7123}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+U\+C\+C\+E\+SS}, 
\hyperlink{group__util__xmodem_ggaca3fc49d80cd9afccc34812b2985484faf97088a6d2705daabd8e016542aa112e}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+F\+A\+I\+L\+U\+RE}
 \}\begin{DoxyCompactList}\small\item\em Values for {\ttfamily state} member of \hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t}. \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\+\_\+xmodem\+\_\+debug int \hyperlink{group__util__xmodem_ga728dd61f38b5563fe2ab45bcb982a1e7}{xbee\+\_\+xmodem\+\_\+use\+\_\+serport} (\hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} $\ast$xbxm, \hyperlink{structxbee__serial__t}{xbee\+\_\+serial\+\_\+t} $\ast$serport)
\begin{DoxyCompactList}\small\item\em Used for xmodem transfers over a simple serial port. \end{DoxyCompactList}\item 
\+\_\+xmodem\+\_\+debug int \hyperlink{group__util__xmodem_gaa71f0823f6fc8db3f7c556819079b225}{xbee\+\_\+xmodem\+\_\+set\+\_\+source} (\hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} $\ast$xbxm, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$buffer, \hyperlink{group__util__xmodem_ga25f49dbd4c2f9e274a32217a709d6382}{xbee\+\_\+xmodem\+\_\+read\+\_\+fn} read, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$context)
\begin{DoxyCompactList}\small\item\em Configure the data source for the Xmodem send. \end{DoxyCompactList}\item 
\+\_\+xmodem\+\_\+debug int \hyperlink{group__util__xmodem_ga3153bea635e130326e96720fe354852d}{xbee\+\_\+xmodem\+\_\+set\+\_\+stream} (\hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} $\ast$xbxm, \hyperlink{group__util__xmodem_ga25f49dbd4c2f9e274a32217a709d6382}{xbee\+\_\+xmodem\+\_\+read\+\_\+fn} read, \hyperlink{group__util__xmodem_ga57f329cc7f4e1b18f5baddb888221d7f}{xbee\+\_\+xmodem\+\_\+write\+\_\+fn} write, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\+AR} $\ast$context)
\begin{DoxyCompactList}\small\item\em Configure the stream used to communicate with the target. \end{DoxyCompactList}\item 
\+\_\+xmodem\+\_\+debug int \hyperlink{group__util__xmodem_gabc8da474bce7043eef3537bd492c5123}{xbee\+\_\+xmodem\+\_\+tx\+\_\+init} (\hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} $\ast$xbxm, \hyperlink{group__hal__dos_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\+\_\+t} flags)
\begin{DoxyCompactList}\small\item\em Initialize state structure for use with \hyperlink{group__util__xmodem_ga1de6d8cc3628767d877e854f92ab2b0e}{xbee\+\_\+xmodem\+\_\+tx\+\_\+tick()} to send a file via Xmodem. \end{DoxyCompactList}\item 
\+\_\+xmodem\+\_\+debug int \hyperlink{group__util__xmodem_ga1de6d8cc3628767d877e854f92ab2b0e}{xbee\+\_\+xmodem\+\_\+tx\+\_\+tick} (\hyperlink{structxbee__xmodem__state__t}{xbee\+\_\+xmodem\+\_\+state\+\_\+t} $\ast$xbxm)
\begin{DoxyCompactList}\small\item\em Function to drive the Xmodem send state machine. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Xmodem Control Characters}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__util__xmodem_ga23d8e7fbbf55d1899984aad6f2dd0c77}{X\+M\+O\+D\+E\+M\+\_\+\+N\+AK}~0x15
\begin{DoxyCompactList}\small\item\em receiver requests X\+M\+O\+D\+EM (with checksum), or did not receive last block \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga5a28173b1f4d064e2b81c71394fe0d82}{X\+M\+O\+D\+E\+M\+\_\+\+C\+RC}~\textquotesingle{}C\textquotesingle{}
\begin{DoxyCompactList}\small\item\em receiver requests X\+M\+O\+D\+E\+M-\/\+C\+RC \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga516766421552c726b2859228d39b867e}{X\+M\+O\+D\+E\+M\+\_\+\+S\+OH}~0x01
\begin{DoxyCompactList}\small\item\em start of 128-\/byte block \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga743b9b571f66fa34a38f8c23407a206f}{X\+M\+O\+D\+E\+M\+\_\+\+S\+TX}~0x02
\begin{DoxyCompactList}\small\item\em start of 1024-\/byte block \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga15cc4ebc5babe213c14409b8dcc08151}{X\+M\+O\+D\+E\+M\+\_\+\+A\+CK}~0x06
\begin{DoxyCompactList}\small\item\em acknowledge receipt of block \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga98471c6c9e395769b006dabdfcbf6990}{X\+M\+O\+D\+E\+M\+\_\+\+C\+AN}~0x18
\begin{DoxyCompactList}\small\item\em cancel transmission \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_gad06c7c58d8c4d733f356bbd48502c7f1}{X\+M\+O\+D\+E\+M\+\_\+\+E\+OT}~0x04
\begin{DoxyCompactList}\small\item\em sender is ending transmission \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Values for \textbackslash{}c flags member of xbee\+\_\+xmodem\+\_\+state\+\_\+t}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__util__xmodem_ga04349c37c905b515c4a61bbfbfefcac9}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+N\+O\+NE}~0x0000
\begin{DoxyCompactList}\small\item\em macro for \char`\"{}no flags\char`\"{}, used when calling xbee\+\_\+xmodem\+\_\+tx\+\_\+init \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga3410ae9b9e3d434bb735ba6b6705f9f4}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+C\+H\+E\+C\+K\+S\+UM}~0x0001
\begin{DoxyCompactList}\small\item\em blocks end with a 1-\/byte checksum \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga84ededd1cb6ac229e18cd5936943aa9e}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+C\+RC}~0x0002
\begin{DoxyCompactList}\small\item\em blocks end with a 16-\/bit C\+RC \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga6c1de4e76820a95412e7db3faa9fd250}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+R\+C\+E\+\_\+\+C\+RC}~0x0008
\begin{DoxyCompactList}\small\item\em force use of X\+M\+O\+D\+E\+M-\/\+C\+RC (by ignoring N\+AK at start of transfer) \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_gaaf04a39f137887085821e34f3e808ee1}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+M\+A\+S\+K\+\_\+\+B\+L\+O\+C\+K\+S\+I\+ZE}~0x0300
\begin{DoxyCompactList}\small\item\em mask for determining block size \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga46eeab5e2a5ef0efbdb5f0706fa9f26c}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+128}~0x0000
\begin{DoxyCompactList}\small\item\em 128-\/byte blocks (default setting) \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga9c55ba56c6cba75308ee8b0b8594a6c4}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+64}~0x0100
\begin{DoxyCompactList}\small\item\em 64-\/byte blocks -- non-\/standard block size used for O\+TA updates \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga2a13979799d1a7ef697025608545f995}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+1K}~0x0200
\begin{DoxyCompactList}\small\item\em 1\+KB blocks \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga177f2ec8f42b568c7f461f729f00bf2b}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+1024}~\hyperlink{group__util__xmodem_ga2a13979799d1a7ef697025608545f995}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+1K}
\begin{DoxyCompactList}\small\item\em alternate macro name for \hyperlink{group__util__xmodem_ga2a13979799d1a7ef697025608545f995}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+1K} \end{DoxyCompactList}\item 
\#define \hyperlink{group__util__xmodem_ga6e934cd774ca499fd24333c2d7ef4bda}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+U\+S\+ER}~(\hyperlink{group__util__xmodem_gaaf04a39f137887085821e34f3e808ee1}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+M\+A\+S\+K\+\_\+\+B\+L\+O\+C\+K\+S\+I\+ZE} $\vert$ \hyperlink{group__util__xmodem_ga6c1de4e76820a95412e7db3faa9fd250}{X\+B\+E\+E\+\_\+\+X\+M\+O\+D\+E\+M\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+R\+C\+E\+\_\+\+C\+RC})
\begin{DoxyCompactList}\small\item\em mask of user-\/settable flags that can be passed to xbee\+\_\+xmodem\+\_\+tx\+\_\+init \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Xmodem A\+PI used with firmware updates. 

Makes use of \hyperlink{serial_8h}{xbee/serial.\+h} A\+PI for sending and receiving serial data. 